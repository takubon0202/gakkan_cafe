// ===================================
// カフェマニュアル - 初期データ
// ===================================

// データバージョン（data.jsを更新したら必ずこの番号を上げる）
const DATA_VERSION = '20251223-1';

const initialData = {
    menu: {
        cafeLatte: {
            id: 'cafeLatte',
            name: 'カフェラテ',
            englishName: 'Cafe Latte',
            category: 'ラテメニュー',
            difficulty: 1,
            price: 400,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'コーヒー豆（すり切り2杯）',
                '牛乳 100ml'
            ],
            equipment: [
                'エスプレッソマシン',
                '電子レンジ',
                'ミルクフォーマー',
                'カップ'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: '豆をセット', description: 'マシンに豆をすり切り2杯入れる。' },
                { number: 2, title: 'エスプレッソ抽出', description: '3つの量のボタンのうち、真ん中を押して抽出する。' },
                { number: 3, title: 'ミルクを温める', description: '牛乳100mlをレンジで温める。', tips: ['スタート押すだけ！！'] },
                { number: 4, title: 'ミルクをスチーム', description: '温めたミルクをフォーマーでスチームする。', tips: ['泡がきめ細かくなるまで、20秒程'] },
                { number: 5, title: '仕上げ', description: 'カップの縁いっぱいにミルクを注いで完成。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        cafeMocha: {
            id: 'cafeMocha',
            name: 'カフェモカ',
            englishName: 'Cafe Mocha',
            category: 'ラテメニュー',
            difficulty: 2,
            price: 400,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'コーヒー豆（すり切り2杯）',
                'チョコソース 30cc',
                '牛乳 200ml',
                'ホイップ'
            ],
            equipment: [
                'エスプレッソマシン',
                '電子レンジ',
                'カップ'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: '豆をセット', description: 'マシンに豆をすり切り2杯入れる。' },
                { number: 2, title: 'ソースを入れる', description: 'チョコソースを30ccカップに入れる。' },
                { number: 3, title: 'エスプレッソ抽出', description: '3つの量のボタンのうち、最小を押してソースの入ったカップに抽出する。' },
                { number: 4, title: '混ぜる', description: 'しっかり目に混ぜる。' },
                { number: 5, title: 'ミルクを温める', description: '牛乳200mlをレンジで温める。', tips: ['飲み物→スタート'] },
                { number: 6, title: '注ぐ', description: 'カップにミルクをカップの縁から12mm下まで注ぐ。' },
                { number: 7, title: '仕上げ', description: 'ホイップをのせて完成。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        caramelMacchiato: {
            id: 'caramelMacchiato',
            name: 'キャラメルマキアート',
            englishName: 'Caramel Macchiato',
            category: 'ラテメニュー',
            difficulty: 3,
            price: 400,
            volume: '約240mL（HOT/ICE）',
            duration: '約2分',
            ingredients: [
                'コーヒー豆（すり切り2杯）',
                'バニラシロップ 10cc（ポンプ2プッシュ）',
                'キャラメルソース 20cc',
                '牛乳 90ml'
            ],
            equipment: [
                'エスプレッソマシン',
                '電子レンジ',
                'ミルクフォーマー',
                'カップ'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: '豆をセット', description: 'マシンに豆をすり切り2杯入れる。' },
                { number: 2, title: 'シロップを入れる', description: 'バニラシロップ10cc（ポンプ2プッシュ）、キャラメル20ccをカップに入れる。' },
                { number: 3, title: 'ミルクを温める', description: '牛乳90mlをレンジで温める。', tips: ['スタート押すだけ！！'] },
                { number: 4, title: 'ミルクをスチーム', description: '温めたミルクをフォーマーでスチームする。', tips: ['泡がきめ細かくなるまで、20秒程'] },
                { number: 5, title: 'ミルクを注ぐ', description: 'スチームしたミルクをシロップの入ったカップに注ぐ。' },
                { number: 6, title: '混ぜる', description: 'よく混ぜる！！' },
                { number: 7, title: 'エスプレッソ抽出', description: '3つの量のボタンのうち、真ん中を押してミルクの入ったカップに抽出する。' },
                { number: 8, title: '仕上げ', description: '仕上げにキャラメルソースをいい感じにかけて完成。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        vanillaLatte: {
            id: 'vanillaLatte',
            name: 'バニララテ',
            englishName: 'Vanilla Latte',
            category: 'ラテメニュー',
            difficulty: 2,
            price: 400,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'コーヒー豆（すり切り1杯）',
                'バニラシロップ 20cc（ポンプ4プッシュ）',
                '牛乳 250ml'
            ],
            equipment: [
                'エスプレッソマシン',
                '電子レンジ',
                'ミルクフォーマー',
                'カップ'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: '豆をセット', description: 'マシンに豆をすり切り1杯入れる。' },
                { number: 2, title: 'シロップを入れる', description: 'バニラシロップ20cc（ポンプ4プッシュ）をカップに入れる。' },
                { number: 3, title: 'エスプレッソ抽出', description: '3つの量のボタンのうち、最小を押してシロップの入ったカップに抽出する。' },
                { number: 4, title: 'ミルクを温める', description: '牛乳250mlをレンジで温める。', tips: ['飲み物→スタート'] },
                { number: 5, title: 'ミルクをスチーム', description: '温めたミルクをフォーマーでスチームする。', tips: ['泡がきめ細かくなるまで、20秒程'] },
                { number: 6, title: '仕上げ', description: 'カップの縁いっぱいにミルクを注いで完成。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        whiteMocha: {
            id: 'whiteMocha',
            name: 'ホワイトモカ',
            englishName: 'White Mocha',
            category: 'ラテメニュー',
            difficulty: 2,
            price: 400,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'コーヒー豆（すり切り2杯）',
                'ホワイトチョコソース 20cc',
                'バニラシロップ 10cc',
                '牛乳 200ml',
                'ホイップ'
            ],
            equipment: [
                'エスプレッソマシン',
                '電子レンジ',
                'カップ'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: '豆をセット', description: 'マシンに豆をすり切り2杯入れる。' },
                { number: 2, title: 'ソースを入れる', description: 'ホワイトチョコソースを20cc、バニラシロップを10ccカップに入れる。' },
                { number: 3, title: 'エスプレッソ抽出', description: '3つの量のボタンのうち、最小を押してソースの入ったカップに抽出する。' },
                { number: 4, title: '混ぜる', description: 'しっかり目に混ぜる。' },
                { number: 5, title: 'ミルクを温める', description: '牛乳200mlをレンジで温める。', tips: ['飲み物→スタート'] },
                { number: 6, title: '注ぐ', description: 'カップにミルクをカップの縁から12mm下まで注ぐ。' },
                { number: 7, title: '仕上げ', description: 'ホイップをのせて完成。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        chaiLatte: {
            id: 'chaiLatte',
            name: 'チャイラテ',
            englishName: 'Chai Latte',
            category: 'ラテメニュー',
            difficulty: 2,
            price: 500,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'チャイシロップ 40cc',
                'お湯 100ml',
                '牛乳 150ml'
            ],
            equipment: [
                '電子レンジ',
                'ミルクフォーマー',
                'カップ'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: 'シロップを入れる', description: 'チャイシロップ40ccをカップに入れる。' },
                { number: 2, title: 'お湯を入れる', description: 'お湯100mlをカップに入れる。' },
                { number: 3, title: 'ミルクを温める', description: '牛乳150mlをレンジで温める。', tips: ['スタートだけ押す'] },
                { number: 4, title: 'ミルクをスチーム', description: '温めたミルクをフォーマーでスチームする。', tips: ['泡がきめ細かくなるまで、20秒程'] },
                { number: 5, title: '仕上げ', description: 'カップの縁いっぱいにミルクを注いで完成。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        matchaLatte: {
            id: 'matchaLatte',
            name: '抹茶ラテ',
            englishName: 'Matcha Latte',
            category: 'ラテメニュー',
            price: 500,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'バニラシロップ',
                '抹茶パウダー',
                'お湯',
                'ミルク'
            ],
            equipment: [
                'スチームノズルとミルクピッチャー',
                '小さなスプーンまたはミニホイッパー',
                'カップ（ホット/アイス）'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: 'ミルクをスチーム', description: '牛乳　　㎖（普通のラテより半分少なめ）をスチームする。' },
                { number: 2, title: 'シロップ・抹茶', description: 'カップにバニラシロップ　　㎖、抹茶パウダー　　g を入れる。' },
                { number: 3, title: 'お湯', description: 'カップの半分くらいまでお湯を入れて、よく混ぜる。' },
                { number: 4, title: '注ぐ', description: 'カップの縁から6㎜くらい下までスチームミルクを注ぐ。', tips: ['フォームミルクをスプーンなどで避けながら注ぐ。'] },
                { number: 5, title: '仕上げ', description: 'フォームミルクをカップの縁まで乗せる。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        hojichaLatte: {
            id: 'hojichaLatte',
            name: 'ほうじ茶ラテ',
            englishName: 'Hojicha Latte',
            category: 'ラテメニュー',
            price: 500,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'ホワイトチョコソース',
                'ほうじ茶パウダー',
                'お湯',
                'ミルク'
            ],
            equipment: [
                'スチームノズルとミルクピッチャー',
                '小さなスプーンまたはミニホイッパー',
                'カップ（ホット/アイス）'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: 'ミルクをスチーム', description: '牛乳　　㎖（普通のラテより半分少なめ）をスチームする。' },
                { number: 2, title: 'ソース・パウダー', description: 'カップにホワイトチョコソース　　㎖、ほうじ茶パウダー　　g を入れる。' },
                { number: 3, title: 'お湯', description: 'カップの半分くらいまでお湯を入れて、よく混ぜる。' },
                { number: 4, title: '注ぐ', description: 'カップの縁から6㎜くらい下までスチームミルクを注ぐ。', tips: ['フォームミルクをスプーンなどで避けながら注ぐ。'] },
                { number: 5, title: '仕上げ', description: 'フォームミルクをカップの縁まで乗せる。' }
            ],
            troubleshooting: [],
            qualityStandards: [],
            variations: [],
            cleaning: [],
            references: []
        },
        coffee: {
            id: 'coffee',
            name: 'コーヒー（HOT / ICE）',
            englishName: 'Coffee',
            category: 'コーヒー・ティー',
            price: 300,
            volume: '約240mL（アイスは氷込み）',
            duration: '約1分',
            ingredients: [
                'コーヒーメーカー用コーヒー豆（エスプレッソ用とは別の豆）',
                '水（給水タンクに十分な量）',
                '氷（アイス用）'
            ],
            equipment: [
                'コーヒーメーカーまたはドリッパー',
                'カップ（ホット）、グラス＋氷（アイス）'
            ],
            allergens: ['特定原材料なし'],
            warnings: [
                '抽出中は本体を動かさない',
                'アイスは氷を先にグラスへ入れて急冷する',
                'エスプレッソマシンとは違う豆を使用する'
            ],
            steps: [
                { number: 1, title: '準備', description: '豆をセットし、給水タンクに水を入れる。アイスはグラスに氷を入れておく。', tips: ['豆量と挽き目を確認'] },
                { number: 2, title: '抽出', description: 'ドリッパーとサーバーをセットし、スタートボタンで抽出。', tips: ['抽出目安は1分以内'] },
                { number: 3, title: '提供', description: 'ホットは温めたカップへ。アイスは氷を満たしたグラスに注ぎ、急冷して提供。', tips: ['氷で薄まらないよう濃い目に抽出すると安定'] }
            ],
            troubleshooting: [
                { problem: '味が薄い', solution: '豆量を増やすか挽き目を細かくする。' },
                { problem: 'えぐみが出る', solution: '抽出時間を短くし、温度を安定させる。' }
            ],
            qualityStandards: [
                '香りが立ち、雑味が少ない',
                'アイスは急冷し、氷が溶けすぎない',
                '提供1分以内'
            ],
            variations: [
                'ミルク追加でカフェオレに',
                'シロップ追加で甘さ調整'
            ],
            cleaning: [
                'ドリッパーとサーバーを抽出後すぐ洗浄',
                'マシンのトレー・カス受けを営業後に洗浄'
            ],
            references: ['Campus Cafe Proposal：商品オペレーション']
        },
        earlGreyTea: {
            id: 'earlGreyTea',
            name: 'アールグレイティー',
            englishName: 'Earl Grey Tea',
            category: 'コーヒー・ティー',
            price: 300,
            volume: '約240mL（HOT/ICE）',
            duration: '約1分',
            ingredients: [
                'アールグレイティーバッグ 1個',
                '熱湯 200mL',
                '氷（アイス用）'
            ],
            equipment: [
                'ティーカップまたは耐熱グラス',
                'タイマー'
            ],
            allergens: ['特定原材料なし'],
            warnings: [
                '抽出時間が長すぎると渋みが出る',
                'アイスはグラスに氷を先に入れ急冷する'
            ],
            steps: [
                { number: 1, title: 'カップ準備', description: 'ホットはカップを温める。アイスは氷をグラスに入れておく。', tips: [] },
                { number: 2, title: '抽出', description: 'ティーバッグを入れ、熱湯を注ぎ2〜3分蒸らす。', tips: ['タイマーで時間を管理'] },
                { number: 3, title: '提供', description: 'ホットはバッグを取り出し提供。アイスは濃いめに抽出して氷に注ぎ急冷。', tips: ['渋みを抑えるため抽出後はバッグを長時間入れない'] }
            ],
            troubleshooting: [
                { problem: '渋みが強い', solution: '抽出時間を2分程度に短縮し、バッグを早めに取り出す。' },
                { problem: '香りが弱い', solution: '熱湯温度を95℃前後にし、蒸らし時間を3分にする。' }
            ],
            qualityStandards: [
                'ベルガモットの香りが立つ',
                '渋みが少なくクリアな味わい',
                '提供1分以内（抽出時間を除く）'
            ],
            variations: [
                'レモンやミルクを追加しても可',
                'アイスティーはガムシロを先に溶かすと混ざりやすい'
            ],
            cleaning: [
                'ティーポットやカップは使用後すぐに洗浄',
                '提供エリアを拭き取り水滴を残さない'
            ],
            references: ['Campus Cafe Proposal：商品オペレーション']
        },
        teaLatte: {
            id: 'teaLatte',
            name: 'ティーラテ',
            englishName: 'Tea Latte',
            category: 'ラテメニュー',
            difficulty: 2,
            price: 500,
            volume: '約240mL（HOT/ICE）',
            duration: '約3分',
            ingredients: [
                'バニラシロップ 30cc',
                'ティーパック 1個',
                'お湯（カップ半分程度）',
                '牛乳 150ml'
            ],
            equipment: [
                '電子レンジ',
                'ミルクフォーマー',
                'カップ'
            ],
            allergens: ['乳'],
            warnings: [],
            steps: [
                { number: 1, title: 'シロップを入れる', description: 'バニラシロップ30ccをカップに入れる。' },
                { number: 2, title: 'ティーパックを入れる', description: 'ティーパックを入れてタグをカップの縁に挿す。' },
                { number: 3, title: 'お湯を入れる', description: 'カップの半分くらいまでお湯を入れる。' },
                { number: 4, title: 'ミルクを温める', description: '牛乳150mlをレンジで温める。', tips: ['スタートだけ押す'] },
                { number: 5, title: 'ミルクをスチーム', description: '温めたミルクをフォーマーでスチームする。', tips: ['泡がきめ細かくなるまで、20秒程'] },
                { number: 6, title: '仕上げ', description: 'カップの縁いっぱいにミルクを注いで完成。' }
            ],
            troubleshooting: [],
            qualityStandards: ['メニューにないけど一番おいしいかも！試してみてね'],
            variations: [],
            cleaning: [],
            references: []
        },
    },
    cleaning: {
        daily: {
            name: '日次清掃・衛生管理',
            description: '営業日ごとに実施する基本衛生管理。清掃・手洗い・服装・温度・ゴミ処理を必ず実施。',
            warnings: [
                '清掃は必ず設備が冷えてから実施する',
                '洗剤や水分が電装部に入らないよう注意する',
                'ゴミは密閉して毎日廃棄する'
            ],
            tasks: [
                {
                    id: 'd1',
                    title: '施設・設備の清掃（開店前／閉店後）',
                    description: '調理場・客席・トイレを清掃し、調理台・テーブルは洗浄後にアルコール消毒。排水溝はブラシで洗い乾燥させる。',
                    notes: [
                        '高接触部位（冷蔵庫取っ手、スイッチ類）は除菌シートで拭く',
                        '清掃後は水気・洗剤残りがないか確認'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'd2',
                    title: 'ゴミ分別・廃棄（閉店時）',
                    description: '燃えるゴミ／プラ／資源ごみを分別し、密閉して所定の廃棄場所へ。飲み残しは別処理してから袋詰め。',
                    notes: [
                        '蓋付きゴミ箱を使用し、虫・臭いを防ぐ',
                        '飲み残しはリキッドボックス等で分離'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'd3',
                    title: '手洗いの徹底',
                    description: 'トイレ後・清掃後・調理前・提供前に石鹸＋流水で手洗いし、アルコール消毒。ペーパータオルで水気を取る。',
                    notes: [
                        '爪は短く、傷がある場合は手袋着用',
                        '手洗い手順を掲示し、スタッフ全員で遵守'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'd4',
                    title: '服装・装備',
                    description: '清潔な制服・エプロン・帽子・マスクを着用。髪はまとめ、アクセサリーは外す。汚れがあれば交換。',
                    notes: [
                        '手袋は汚れたら即交換',
                        '髪は帽子の中に収める'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'd5',
                    title: '温度管理（冷蔵/冷凍）',
                    description: '冷蔵5℃以下／冷凍-18℃以下を1日2回記録。異常時は責任者へ報告し点検を依頼。',
                    notes: [
                        '温度計の位置を固定し、誤差を減らす',
                        '記録は日次シートに残す'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'd6',
                    title: '食材受け入れ・保管',
                    description: '納品時に温度・賞味期限・品質を確認し、区分保管（冷蔵/冷凍/常温）。先入れ先出しを徹底。',
                    notes: [
                        '交差汚染防止のため、生鮮と乾物を分ける',
                        '高温に弱い品は速やかに冷蔵・冷凍'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                }
            ]
        },
        weekly: {
            name: '週次清掃・点検',
            description: '週1回の定期清掃・点検で衛生状態をリセット。',
            warnings: [
                '排水溝や換気扇の分解洗浄時は電源OFFを確認',
                '薬剤の取扱いは手袋・換気を徹底'
            ],
            tasks: [
                {
                    id: 'w1',
                    title: '換気扇・排水溝の洗浄',
                    description: '換気扇フィルタと排水溝を洗浄・乾燥させ、においとカビを防止。',
                    notes: [
                        '洗浄後は完全乾燥を確認',
                        'フィルタ破損がないか点検'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'w2',
                    title: '温度記録レビュー',
                    description: '1週間の温度記録を確認し、異常がないか振り返る。異常値があれば設備点検を依頼。',
                    notes: [
                        '記録漏れがあれば追記し、原因を共有',
                        '温度計の校正時期も確認'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'w3',
                    title: '健康チェック表の確認',
                    description: 'スタッフの健康チェック表を確認し、体調不良者がいないかを確認。必要に応じてシフト調整。',
                    notes: [
                        '発熱・嘔吐・下痢がある場合は出勤停止',
                        '接触箇所の消毒を指示'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                }
            ]
        },
        monthly: {
            name: '月次衛生レビュー',
            description: '月1回の総点検と資材チェックを実施。',
            warnings: [
                '在庫確認は消費期限も同時に確認する',
                '設備点検は安全に配慮し、必要に応じ専門業者へ連絡'
            ],
            tasks: [
                {
                    id: 'm1',
                    title: '設備・備品チェック',
                    description: '冷蔵庫・冷凍庫・換気扇・排水溝の状態を確認し、必要ならメンテ依頼。温度計や清掃用具の劣化を点検。',
                    notes: [
                        '温度計の故障・電池切れを確認',
                        '排水溝ブラシなどの交換時期を記録'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'm2',
                    title: '衛生教育振り返り',
                    description: '衛生・清掃の遵守状況を共有し、改善点を決定。手順書を必要に応じ更新。',
                    notes: [
                        'NG事例やヒヤリハットを共有',
                        '新メンバー向けに手順を再確認'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                },
                {
                    id: 'm3',
                    title: '資材・消耗品在庫確認',
                    description: '洗剤・アルコール・手袋・ゴミ袋・ブラシなどを棚卸しし、不足分を発注。',
                    notes: [
                        '在庫と発注単位をメモして共有',
                        '期限切れの薬剤がないか確認'
                    ],
                    completed: false,
                    completedAt: null,
                    imageIds: []
                }
            ]
        }
    },
    troubleshooting: [
        {
            id: 't1',
            title: 'マシンが起動しない',
            problem: '電源ボタンを押しても反応がない',
            solutions: [
                '電源プラグがコンセントに差し込まれているか確認してください',
                '本体背面の主電源スイッチが「入」になっているか確認してください',
                '別のコンセントで試してみてください',
                '上記で解決しない場合はサービスセンターに連絡してください'
            ]
        },
        {
            id: 't2',
            title: 'コーヒーが抽出されない',
            problem: 'ボタンを押してもコーヒーが出てこない',
            solutions: [
                '水タンクに十分な水が入っているか確認してください',
                '豆ホッパーにコーヒー豆が入っているか確認してください',
                '抽出ユニットが正しくセットされているか確認してください',
                'コーヒーカス受けが満杯になっていないか確認してください（カス受けアイコンの点滅）',
                '抽出口や抽出ユニットが目詰まりを起こしている場合は清掃してください',
                '大きな音がする場合は、本体の水経路に空気が入っている可能性があります。給湯機能でお湯を出してください'
            ]
        },
        {
            id: 't3',
            title: 'コーヒーがぬるい',
            problem: 'コーヒーの温度が低い',
            solutions: [
                'エスプレッソの理想温度は67-70℃前後です。一般的なドリップコーヒー（85℃前後）と比べてぬるく感じることがありますが、異常ではありません',
                'カップが温まっていない場合は、給湯機能を使ってカップを湯煎してください',
                '本体内部が温まっていない場合は、手動内部洗浄を行い、本体内部を温めてください',
                '抽出温度の設定が低い場合は、「レベル3」や「レベル4」に設定してください'
            ]
        },
        {
            id: 't4',
            title: 'コーヒーがクリーミーでない（クレマがない／少ない）',
            problem: 'エスプレッソの表面にクレマが形成されない',
            solutions: [
                'コーヒー豆の挽き具合が粗すぎる場合は、グラインダーノブを細かいほう（反時計回り）に1目盛回してください',
                '新鮮なエスプレッソ用の豆を使用してください',
                'コーヒー粉から抽出する場合は、粉の量を増やしてください（最大：計量スプーン山盛り1杯）',
                '新鮮なエスプレッソ用の粉（極細挽き～細挽き）を使用してください'
            ]
        },
        {
            id: 't5',
            title: '抽出が遅い（ポタポタとしか抽出されない）',
            problem: 'コーヒーの抽出速度が非常に遅い',
            solutions: [
                '抽出口や抽出ユニットが目詰まりを起こしている場合は清掃してください',
                'コーヒー豆の挽き具合が細かすぎる場合は、グラインダーノブを粗いほう（時計回り）に1目盛回してください',
                '挽かれたコーヒー豆の量が多すぎる場合は、豆量調整つまみをMINのほう（反時計回り）に回してください',
                'コーヒー粉の量が多すぎる場合は、投入するコーヒー粉の量を減らしてください',
                '電源が「切」のときにコーヒー粉を投入した場合は、内部に粉が飛び散るため、本体内部および抽出ユニットの清掃を行ってから再度抽出してください'
            ]
        },
        {
            id: 't6',
            title: 'コーヒーが片方の抽出口からしか出てこない',
            problem: '2杯抽出時に片方しか出ない',
            solutions: [
                '片方の抽出口が詰まっています。抽出口を清掃してください',
                '本体が水平に設置されているか確認してください'
            ]
        },
        {
            id: 't7',
            title: '大きな音がして、抽出口からコーヒーなどが出ない',
            problem: '異常な音がしてお湯やコーヒーが出ない',
            solutions: [
                '本体の水経路に空気が入っています。給湯機能でお湯を出してください（スチームノブを「I」まで回し、お湯が出るまで給湯）'
            ]
        },
        {
            id: 't8',
            title: 'スチームが出ない',
            problem: 'スチームノブを「I」の位置に回してもスチームが出ない',
            solutions: [
                '水タンクに水がない場合は、水タンクに水を入れてください',
                'スチームノズルが目詰まりしている場合は、フロッサーとスチームノズルを清掃してください',
                'スチームランプが点滅してから30秒以上経過した場合は、もう一度スチームボタンを押して、スチームランプが点滅したら、スチームノブを「I」の位置へ回してください'
            ]
        },
        {
            id: 't9',
            title: 'スチームが水っぽい',
            problem: 'スチームから水が多く出る',
            solutions: [
                'スチームの予熱が完了していません。スチームランプが点滅してから、スチームを出してください'
            ]
        },
        {
            id: 't10',
            title: 'スチームが急に出なくなる',
            problem: 'スチーム使用中に突然停止する',
            solutions: [
                'スチームを出し始めて3分が経過したため、安全装置が作動し、スチームが止まりました。スチームノブを「〇」の位置に戻してください',
                '水タンクに水がない場合は、水タンクに水を入れてください'
            ]
        },
        {
            id: 't11',
            title: '牛乳の泡立ちが悪い（フォームミルクがうまくできない）',
            problem: 'ミルクが泡立たない',
            solutions: [
                '新鮮で冷えた成分無調整／乳脂肪分3.0%以上の牛乳を使ってください',
                '口径が小さく深めのもの（金属製）のミルクジャグを使ってください',
                'フロッサー、スチームノズルの穴が目詰まりしている場合は清掃してください',
                'スチーム管のOリングが破損または欠損している場合は、当社へご連絡ください'
            ]
        },
        {
            id: 't12',
            title: '電源ボタンを押すとすぐに予熱ランプが点滅し続ける',
            problem: '電源が入らず予熱ランプが点滅',
            solutions: [
                'スチームノブが「I」の位置にある状態で電源ボタンを押しました。スチームノブを「〇」の位置まで回してください'
            ]
        },
        {
            id: 't13',
            title: 'カス受けをお手入れしてもカス受けアイコンの表示が消えない',
            problem: 'カス受けを清掃したのにアイコンが消えない',
            solutions: [
                'カスを捨ててからすぐにカス受けを取り付けるとアイコンは消えません。10秒程度待ってからカス受けを取り付けてください'
            ]
        },
        {
            id: 't14',
            title: '電源を「入」にした後にカス受けアイコンが点滅する',
            problem: '起動時にカス受けアイコンが点滅',
            solutions: [
                'カス受けのお手入れ後、最初のコーヒー抽出から72時間以上経過しました。カス受けをお手入れしてください',
                '衛生のため、お手入れ後、最初のコーヒー抽出から約72時間後にカス受けアイコンが点滅します（本体背面の主電源スイッチを「切」にすると72時間のカウントはリセットされます）'
            ]
        },
        {
            id: 't15',
            title: 'お手入れの際、抽出ユニットが取り外せない',
            problem: '抽出ユニットが外れない',
            solutions: [
                '抽出ユニットは、電源が「切」のときのみ取り外すことができます。本体の電源を「切」にしてから取り外してください',
                '無理に取り外そうとすると、故障の原因になります'
            ]
        },
        {
            id: 't16',
            title: '石灰の除去をしても除石灰ランプが点滅する',
            problem: '除石灰プログラム後もランプが消えない',
            solutions: [
                '洗浄やすすぎが完了していなかった可能性があります。水だけで石灰の除去を繰り返し行ってください',
                '石灰の除去の際は、お湯の排出・停止を自動的に繰り返します。途中で電源を切らないでください'
            ]
        },
        {
            id: 't17',
            title: 'グラインダーにコーヒー豆が引き込まれない',
            problem: '豆が挽かれない',
            solutions: [
                '油分の多いコーヒー豆を使用している場合、油分によって豆が豆ホッパーに付着してしまい、グラインダーに引き込まれないときは、豆ホッパーを乾いたふきんで拭いてください'
            ]
        },
        {
            id: 't18',
            title: 'コーヒーの味が悪い',
            problem: '抽出したコーヒーの味がいつもと違う',
            solutions: [
                '豆が古くなっていないか確認してください（開封後2週間以内推奨）',
                'マシンの清掃を実施してください（特に抽出ユニット）',
                '水の味を確認してください（タンクの水は毎日交換）',
                '豆の挽き具合や量を調整してください',
                '石灰が蓄積している可能性があります。除石灰を実施してください'
            ]
        },
        {
            id: 't19',
            title: '異常、故障時の対応',
            problem: '電源プラグ・コードが異常に熱くなる、異常な音やにおいがする、本体に破損や変形がある、本体から水や蒸気が漏れる',
            solutions: [
                '直ちに使用を中止してください',
                '電源プラグをコンセントから抜いてください',
                '販売店または当社へ点検、修理を依頼してください',
                '「表示一覧」「故障かな？」で調べても正常に機能しない場合は、お求めの販売店または当社にご相談ください'
            ]
        }
    ],
    hygiene: {
        staff: {
            title: 'スタッフ用 衛生マニュアル',
            subtitle: '一般衛生管理プログラムの基本項目',
            sections: [
                {
                    id: 'h1',
                    title: '清掃・整理整頓（毎日）',
                    items: [
                        '調理場・客席・トイレを開店前/閉店後に清掃し、調理台・テーブルは洗浄後にアルコール消毒。',
                        '排水溝はブラシで洗い、乾燥させる。高接触部位（取っ手・スイッチ）は除菌シートで拭く。',
                        'ゴミは分別し、密閉して毎日廃棄。飲み残しはリキッドボックス等で分離処理。'
                    ]
                },
                {
                    id: 'h2',
                    title: '従業員の衛生管理',
                    items: [
                        '健康チェック：発熱・嘔吐・下痢などがあれば出勤停止。体調不良は必ず報告。',
                        '手洗い：トイレ後・清掃後・調理/提供前に石鹸＋流水＋消毒。ペーパータオルで水気を除去。',
                        '服装：清潔な制服/エプロン/帽子/マスク。髪はまとめ、アクセサリーは外す。手袋は汚れたら交換。'
                    ]
                },
                {
                    id: 'h3',
                    title: '温度管理',
                    items: [
                        '冷蔵5℃以下／冷凍-18℃以下を1日2回記録。異常時は責任者へ報告し点検。',
                        '温度計は固定位置で使用し、故障・電池切れを確認。'
                    ]
                },
                {
                    id: 'h4',
                    title: '食品の取り扱い',
                    items: [
                        '受け入れ：納品時に温度・賞味期限・品質を確認。不良品は受け入れ拒否・記録。',
                        '保管：区分保管（冷蔵/冷凍/常温）と先入れ先出し。生鮮と乾物を分けて交差汚染防止。',
                        '調理：加熱温度・時間を守り、調理後は速やかに提供。'
                    ]
                },
                {
                    id: 'h5',
                    title: '必要資材・備品一覧',
                    subsections: [
                        {
                            subtitle: '清掃で必要な備品',
                            items: [
                                '薬剤: 中性洗剤、アルコール消毒液、除菌スプレー、除菌シート',
                                '器具: モップ、雑巾、使い捨てペーパータオル、ブラシ（排水溝用）、ゴミ袋（45L検討）、清掃用手袋、使い捨て手袋、温度計（冷蔵庫用）、排水溝ブラシ'
                            ]
                        },
                        {
                            subtitle: '従業員管理で必要な備品',
                            items: [
                                '薬剤: 手指用アルコール消毒液、ハンドソープ',
                                '器具: 非接触体温計、健康チェック表（紙またはシート）、エプロン、手袋、帽子'
                            ]
                        },
                        {
                            subtitle: '設備管理で必要な備品',
                            items: [
                                '薬剤: 中性洗剤、アルコール消毒液',
                                '器具: 温度計（冷蔵庫内固定式）、ブラシ（排水溝用）'
                            ]
                        },
                        {
                            subtitle: '食品取り扱いで必要な備品',
                            items: [
                                '薬剤: アルコール消毒液、食器用洗剤',
                                '器具: 温度計'
                            ]
                        }
                    ]
                },
                {
                    id: 'h6',
                    title: '詳細手順まとめ（清掃・従業員・設備・食品）',
                    items: [
                        '【清掃・整理整頓】担当: 学環生スタッフ／実施時期: 開店前・閉店後／頻度: 営業日。工程: モップ→調理台・テーブル洗浄後アルコール→排水溝ブラシ洗浄・乾燥→高接触部位除菌シート→器具を定位置に戻す。注意: 洗剤残り・水気を除去、清掃用具の汚染に留意。廃棄: 分別し密閉、閉店後廃棄（保管/廃棄場所は事務室に確認）。',
                        '【調理器具の洗浄殺菌】担当: 学環生スタッフ／使用後随時。工程: 洗浄→乾燥→保管。注意: 洗い残し・拭き残し防止、食器洗浄手順は食品衛生責任者ハンドブックを参照。',
                        '【ゴミ分別・廃棄】担当: 学環生スタッフ／閉店後毎日。工程: 分別（燃やせる／プラ／資源）、飲み残しは別途廃棄→密閉→所定場所へ。注意: 未分別による臭い・虫、飲み残し放置を防ぐ。リキッドボックス導入検討、保管/廃棄場所は事務室に相談。',
                        '【従業員の健康チェック】担当: 学環生スタッフ／出勤前・営業日。体調不良（発熱・嘔吐・下痢など）は出勤停止、接触箇所消毒、シフト調整。媒体は紙またはフォーム＋スプレッドシート連携。',
                        '【手洗いの徹底】タイミング: トイレ後・清掃後・調理前・提供前。手順: 水で濡らす→石鹸→十分にこする→流水→水気をペーパーで取る→必要に応じ消毒。傷がある場合は手袋着用。',
                        '【服装管理】勤務前に制服・エプロン・帽子・マスクを着用。髪は帽子の中に収め、長髪は束ねる。指輪・時計等は外す。手袋は汚れたら交換、営業ごとに洗濯。',
                        '【温度管理】冷蔵5℃以下／冷凍-18℃以下を開店前・閉店時に確認（1日2回）。温度計は冷凍庫対応か確認し、異常時は報告。',
                        '【食材保管】区分保管（冷凍: アイスなどすぐ冷凍／常温: 豆は高温多湿・光を避ける）。適温で保管し、高温に弱いものは速やかに収納。'
                    ]
                }
            ]
        },
        manager: {
            title: '責任者・教育用 衛生マニュアル',
            subtitle: '点検・記録・指導用',
            description: '一般衛生管理の確認、温度・健康・清掃の記録と改善を回すためのガイド。',
            sections: [
                {
                    id: 'm1',
                    title: '清掃・消毒フロー',
                    items: [
                        '日次：調理台・器具洗浄→アルコール、床・排水溝洗浄→乾燥、高接触部位の除菌、ゴミ分別・廃棄。',
                        '週次：換気扇フィルタ、排水溝の分解洗浄、温度記録レビュー、健康チェック表確認。',
                        '月次：設備点検（冷蔵庫/冷凍庫/換気/排水）、温度計・清掃用具の劣化確認、衛生教育振り返り。'
                    ]
                },
                {
                    id: 'm2',
                    title: '健康管理とシフト対応',
                    items: [
                        '出勤前：健康チェック表で体調申告。発熱・嘔吐・下痢があれば出勤停止。',
                        '体調不良者が出た場合：接触箇所の消毒、シフト調整、責任者報告。'
                    ]
                },
                {
                    id: 'm3',
                    title: '温度記録と設備管理',
                    items: [
                        '冷蔵5℃以下／冷凍-18℃以下の記録を日次で確認。週次に異常傾向をレビュー。',
                        '温度計の故障・電池切れ、冷蔵庫のパッキン・霜付きを点検し、必要ならメンテ依頼。'
                    ]
                },
                {
                    id: 'm4',
                    title: '食品受け入れ・保管',
                    items: [
                        '納品時に温度・賞味期限・包装破損をチェック。問題品は受け入れ拒否・記録。',
                        '区分保管と先入れ先出しを徹底し、交差汚染を防止。'
                    ]
                },
                {
                    id: 'm5',
                    title: '資材・消耗品管理',
                    items: [
                        '洗剤・アルコール・手袋・ゴミ袋・ブラシ・温度計などを棚卸しし、不足を補充。',
                        '期限切れ薬剤がないか毎月確認。'
                    ]
                },
                {
                    id: 'm6',
                    title: '教育・改善',
                    items: [
                        '衛生・清掃の遵守状況とヒヤリハットを共有し、月次で改善策を決定。',
                        '新人向けに手洗い・清掃・温度記録を実演し、チェックリストを配布。'
                    ]
                },
                {
                    id: 'm7',
                    title: '詳細確認（清掃・従業員・設備・食品）',
                    items: [
                        '清掃手順の遵守確認（モップ→洗浄→消毒→排水溝洗浄→高接触部位除菌→器具定位置）。分別・廃棄の実施と保管場所の確認。',
                        '従業員健康チェックの回収と体調不良時のシフト対応・消毒指示。',
                        '手洗い・服装規律（指輪・時計除去、髪まとめ、手袋交換）を巡回確認。',
                        '温度管理: 冷蔵5℃以下／冷凍-18℃以下を記録し、週次レビュー。温度計・設備異常の早期点検依頼。',
                        '食材受入・保管: 温度・賞味期限・包装破損チェック、区分保管と先入れ先出しの徹底を確認。',
                        'ゴミ・飲み残し処理: 分別・密閉・毎日廃棄、リキッドボックス運用の有無を確認。'
                    ]
                }
            ]
        },
        healthCheck: {
            title: '従業員 健康チェック表',
            subtitle: '体調自己申告と管理者確認用',
            form: {
                fields: [
                    '日付',
                    '氏名',
                    'シフト時間'
                ],
                sections: [
                    {
                        title: '1. 当日の体調（該当するものに ✔ ）',
                        items: [
                            '発熱（37.5℃以上）',
                            'のどの痛み',
                            '咳・くしゃみ・鼻水',
                            '強いだるさ（倦怠感）',
                            '吐き気・嘔吐',
                            '下痢',
                            '腹痛',
                            '食中毒患者との接触あり',
                            'インフルエンザ・ノロウイルス等の疑いあり',
                            '特になし（健康）'
                        ]
                    },
                    {
                        title: '2. 手指の状態',
                        items: [
                            '手指に傷なし',
                            '傷・切り傷あり（絆創膏使用） → 手袋着用必須',
                            '爪が短く整っている',
                            '爪が長い・ささくれあり'
                        ]
                    },
                    {
                        title: '3. 衛生行動',
                        items: [
                            '出勤後の手洗いを実施',
                            '清潔な制服・エプロンを着用',
                            '帽子・マスク（必要時）を着用',
                            'アクセサリー未着用（指輪・時計・ブレスレット等）'
                        ]
                    },
                    {
                        title: '4. 家庭・周囲の状況',
                        items: [
                            '同居家族に発熱者あり',
                            '同居家族に感染症の疑い',
                            '学校・施設内で流行発生',
                            '特になし'
                        ]
                    },
                    {
                        title: '5. 管理者判断（責任者記入欄）',
                        items: [
                            '調理可',
                            '調理不可（接客のみ）',
                            '出勤不可',
                            'コメント（自由記入）',
                            '管理者署名'
                        ]
                    }
                ],
                submission: [
                    '発信媒体案: 紙媒体 または Googleフォーム＋スプレッドシート連携'
                ]
            }
        }
    },
    service: {
        customerService: {
            title: '接客方法',
            flow: [
                {
                    id: 'flow1',
                    step: 1,
                    title: '入店・お出迎え',
                    description: '3秒以内に笑顔で「いらっしゃいませ」。目線を合わせ会釈。混雑時も一度は声かけ、手が離せない時は目線＋会釈で気づきを示す。',
                    image: 'images/service_flow/flow_welcome.png',
                    alt: 'お客様を笑顔でお出迎えするスタッフのイラスト'
                },
                {
                    id: 'flow2',
                    step: 2,
                    title: '席へのご案内',
                    description: '「何名様ですか？」確認後、「○名様ですね。こちらへどうぞ」と先導。メニュー・お水を出し「ご注文がお決まりになりましたらお呼びください」と添える。',
                    image: 'images/service_flow/flow_seating.png',
                    alt: 'お客様を席にご案内するスタッフのイラスト'
                },
                {
                    id: 'flow3',
                    step: 3,
                    title: 'オーダーを取る',
                    description: '「お待たせいたしました。ご注文はお決まりでしょうか？」と声かけ。復唱して確認。アレルギー・苦手は必要に応じ補足。',
                    image: 'images/service_flow/flow_order.png',
                    alt: 'お客様のオーダーを取るスタッフのイラスト'
                },
                {
                    id: 'flow4',
                    step: 4,
                    title: '提供',
                    description: 'トレーは両手で安定。商品名を伝え「お待たせいたしました」。熱い飲み物は「カップが熱いのでお気をつけください」を添える。',
                    image: 'images/service_flow/flow_serving.png',
                    alt: '商品を提供するスタッフのイラスト'
                },
                {
                    id: 'flow5',
                    step: 5,
                    title: 'テーブルフォロー',
                    description: '長時間滞在の方へ水や片付けをさりげなく提案。「お下げしてもよろしいでしょうか？」と確認して下げる。',
                    image: 'images/service_flow/flow_follow_up.png',
                    alt: 'テーブルフォローを行うスタッフのイラスト'
                },
                {
                    id: 'flow6',
                    step: 6,
                    title: '会計',
                    description: '「いらっしゃいませ」「ありがとうございます」を明瞭に。注文内容再確認し金額提示。現金/キャッシュレスを丁寧に案内。受け取った金額はレジ画面やレシートで示す。',
                    image: 'images/service_flow/flow_payment.png',
                    alt: '会計を行うスタッフのイラスト'
                },
                {
                    id: 'flow7',
                    step: 7,
                    title: 'お見送り',
                    description: '「ありがとうございました」「またお待ちしております」と笑顔でお見送り。目線を合わせ軽く会釈。',
                    image: 'images/service_flow/flow_farewell.png',
                    alt: 'お客様をお見送りするスタッフのイラスト'
                }
            ],
            basics: [
                '笑顔・明るい表情をキープ',
                'はっきり聞き取りやすい声で話す（声量は周囲に配慮）',
                '分からないことは「確認してまいります」と伝えてから確認',
                '誰に対しても公平に接する（常連・友人を特別扱いしない）'
            ],
            cautions: {
                ng: [
                    {
                        id: 'ng1',
                        text: '不機嫌・無表情での接客',
                        image: 'images/ng_behaviors/ng_grumpy_face.png',
                        alt: '不機嫌な表情でお客様に対応するスタッフのイラスト'
                    },
                    {
                        id: 'ng2',
                        text: 'スマホ操作やカウンターにもたれながらの接客',
                        image: 'images/ng_behaviors/ng_smartphone_leaning.png',
                        alt: 'スマホを見ながらカウンターにもたれかかるスタッフのイラスト'
                    },
                    {
                        id: 'ng3',
                        text: '私語が多い、特にお客様前や出入口付近',
                        image: 'images/ng_behaviors/ng_chatting.png',
                        alt: 'お客様の前で私語をするスタッフのイラスト'
                    },
                    {
                        id: 'ng4',
                        text: 'オーダーミスの隠蔽（気づいたら即報告・謝罪・作り直し）',
                        image: 'images/ng_behaviors/ng_hiding_mistake.png',
                        alt: 'オーダーミスを隠そうとするスタッフのイラスト'
                    },
                    {
                        id: 'ng5',
                        text: 'お客様前でスタッフや店の悪口を言う',
                        image: 'images/ng_behaviors/ng_badmouthing.png',
                        alt: 'お客様の前でスタッフの悪口を言うスタッフのイラスト'
                    }
                ],
                hygiene: [
                    '制服・エプロンは清潔に。汚れ・シワは交換',
                    '爪は短く、ネイルは原則控える（店舗ルール優先）',
                    '強い香水・柔軟剤は避ける',
                    '長い髪はまとめ、前髪は目・眉にかからないように',
                    'レジ→調理→配膳の切替時などこまめに手洗い・消毒'
                ],
                order: [
                    '復唱を徹底し聞き間違い防止',
                    'アレルギー表示はメニューを指差し確認し説明',
                    '熱い/こぼれやすい商品は一言注意喚起',
                    '提供に時間がかかる場合は目安時間を事前に伝える'
                ],
                claim: [
                    '話を最後まで聞き、さえぎらない',
                    '落ち着いた声で「ご不快な思いをさせ申し訳ございません」と謝罪',
                    '判断できない場合は責任者・リーダーに報告',
                    'その場しのぎの約束はしない（守れない約束はしない）'
                ]
            }
        },
        overview: {
            title: '概要',
            content: [
                'トースター2台。カウンター2人で会計・番号札・受け渡しを担当、トレー運搬1人。',
                '自由席制。番号札で呼び出し、カウンターで受け渡し。返却は返却口へ。',
                '動線: 入口→レジ→カウンター→客席→返却口→退店（提供と返却が交差しないよう配置）。',
                '店内座席: 計31席（グループ席: 2人×3、4人×2／大テーブル: 12席／1人席: 5席）。'
            ]
        },
        layout: {
            title: '店内動線・レイアウト',
            seats: [
                '総席数: 31席',
                'グループ席: 2人×3卓, 4人×2卓',
                '大テーブル: 12席',
                '1人席: 5席'
            ],
            flow: [
                '入口から見て左手にカウンター・レジ、その奥に返却口。',
                '中央に大テーブル、左右にグループ席と1人席を配置。',
                '提供動線: レジ→カウンター→各席／返却動線: 客席→返却口→バックヤード。'
            ],
            notes: [
                '提供と返却が交差しないよう、返却口は入口から少し離して設置。',
                '大テーブル周辺は呼び出しが届きやすい位置。'
            ],
            image: 'images/001.png'
        },
        payments: {
            title: '決済（AirPay）',
            device: 'iPad + AirPayアプリ + AirPayリーダー（クレジット/交通系IC/QR対応）',
            commonFlow: [
                'レジで注文確定 → 金額をAirPayに入力し「会計へ」。',
                '支払い方法を確認し、該当の決済方式を選択。',
                '決済完了後にサイン/暗証/レシート確認を行い、番号札運用に戻る。'
            ],
            methods: [
                {
                    name: 'クレジット/デビット（IC/磁気/タッチ）',
                    steps: [
                        'AirPayで「カード」選択 → 金額確認後に「決済」。',
                        'IC/タッチ: お客様にリーダーへカード/スマホをタップ。磁気: 端末の指示でスワイプ。',
                        '暗証番号入力またはサインを案内（端末画面に従う）。',
                        '決済完了を画面で確認し、レシート希望を確認してプリント。'
                    ],
                    notes: [
                        '一部プリペイドはサイン不要。IC優先、タッチ非対応カードはIC/磁気に切替。'
                    ]
                },
                {
                    name: '交通系IC（Suica/PASMO等）',
                    steps: [
                        'AirPayで「交通系IC」を選択し、金額を確認して「決済」。',
                        'お客様にカード/スマホをリーダーへタッチしてもらう。',
                        '完了音と画面表示を確認し、レシート希望を確認。'
                    ],
                    notes: [
                        '残高不足時は追加チャージ不可のため別決済を案内。',
                        'タッチは平行に置くよう声掛け。'
                    ]
                },
                {
                    name: 'QRコード決済（例: PayPay, 楽天ペイ等）',
                    steps: [
                        'AirPayで該当のQRブランドを選択し、金額を確認して「決済」。',
                        '提示されたQRコードをiPadカメラまたはリーダーで読み取り。',
                        'お客様アプリ側の支払い完了画面を確認し、AirPayで完了表示を確認。'
                    ],
                    notes: [
                        '電波状況が悪い場合はWi-Fiを確認し、再読取する。',
                        '読み取りが難しい場合は輝度アップを案内。'
                    ]
                },
                {
                    name: '現金',
                    steps: [
                        'レジ（POS）で金額を確定し、現金を受領・釣銭を渡す。',
                        'AirPay入力は不要。日報では現金とキャッシュレスを分けて計上。'
                    ],
                    notes: [
                        '小銭・釣銭準備は開店前に確認。'
                    ]
                }
            ]
        },
        hours: {
            title: '営業時間（1月）',
            normal: {
                label: '午前/午後の営業',
                rows: [
                    { day: '月', time: '午前✕ / 午後○', hours: '10:00-12:30 / 15:00-17:00' },
                    { day: '火', time: '午前○ / 午後○', hours: '10:00-12:30 / 15:00-17:00' },
                    { day: '水', time: '午前✕ / 午後○', hours: '10:00-12:30 / 15:00-17:00' },
                    { day: '木', time: '午前✕ / 午後○', hours: '10:00-12:30 / 15:00-17:00' },
                    { day: '金', time: '午前○ / 午後○', hours: '10:00-12:30 / 15:00-17:00' }
                ],
                image: null
            },
            holiday: {
                label: '長期休暇営業時間（週合計20h）※ラストオーダー19:40',
                rows: [
                    { day: '月〜金', time: '11:00〜15:00', hours: '4h/日' }
                ],
                image: null
            }
        },
        staffing: {
            title: '店舗運営・シフト目安',
            summary: [
                '業務時間: 営業開始30分前〜営業終了後30分',
                '1週間の総業務時間: 37時間×3人＝111時間',
                '1人あたり勤務時間: 111 ÷ 32 ≒ 3.47時間（約3時間28分）'
            ],
            notes: [
                '準備・片付けを含めてシフトを組む（開店前30分, 閉店後30分）。',
                '混雑日はカウンター2名 + トレー/返却1名を基本とし、ピーク時は応援を検討。'
            ],
            image: 'images/004.png'
        },
        facilities: {
            title: '設備配置',
            items: [
                {
                    equipment: 'トースター',
                    quantity: '2台',
                    location: 'カウンター内調理エリア',
                    notes: '並列配置で効率的に焼成'
                },
                {
                    equipment: '返却口',
                    quantity: '1箇所',
                    location: 'カウンター近く、入口から見やすい位置',
                    notes: 'トレー・食器・番号札の返却用'
                },
                {
                    equipment: 'ゴミ箱',
                    quantity: '1〜2個',
                    location: '返却口近く',
                    notes: '分別表示を設置。食品動線外に配置'
                },
                {
                    equipment: '番号札立て',
                    quantity: '1箇所',
                    location: 'カウンター上またはレジ横',
                    notes: '返却された番号札を置く'
                }
            ],
            flowNotes: [
                '動線: 入口→レジ→カウンター→客席→返却口→退店（提供/返却の交差を避ける）',
                '入口付近の客導線と返却口付近が交差しないよう、返却口は入口からやや離して設置'
            ]
        },
        roles: {
            title: '役割分担',
            staff: [
                {
                    position: 'カウンター（2人）',
                    responsibilities: [
                        '会計・レジ対応',
                        '番号札の発行・管理',
                        '商品の呼び出し',
                        '商品の受け渡し',
                        'POS操作・メモ記録',
                        '返却口の整理補助（混雑時）'
                    ]
                },
                {
                    position: '(フック) トレーごと（1人）',
                    responsibilities: [
                        'トレーでの商品提供',
                        'トレー・食器の回収',
                        '返却口の整理',
                        'テーブルの清掃・整頓',
                        '※「フック」の意味は要確認（推定: フロア係/トレー運搬係）'
                    ]
                }
            ]
        },
        numberTag: {
            title: '番号札運用',
            flow: [
                {
                    step: '1. 発行',
                    description: 'レジで会計後、番号札を1枚渡す。「番号でお呼びしますので、お好きな席でお待ちください」と案内'
                },
                {
                    step: '2. 設置',
                    description: '使用済み番号札は番号札立てに戻す。次の注文で再利用'
                },
                {
                    step: '3. 呼び出し',
                    description: '商品準備完了後、「○番のお客様、お待たせしました」と呼び出し。カウンターで受け渡し'
                },
                {
                    step: '4. 返却',
                    description: 'お客様が食事後、返却口で番号札をトレーと共に返却。スタッフが番号札を札立てに戻す'
                }
            ],
            notes: [
                '番号札は1日の終わりにアルコール消毒',
                '紛失時は予備を使用し、記録を残す',
                '混雑時は番号を大きく呼ぶ、または呼び出しベルを検討'
            ]
        },
        tray: {
            title: 'トレー運用',
            operations: [
                {
                    action: '提供',
                    procedure: '商品をトレーに載せ、カウンターまたは席まで運ぶ。熱い商品は注意喚起',
                    tips: 'トレーは清潔な状態を保つ。汚れたら即座に交換'
                },
                {
                    action: '回収',
                    procedure: '返却口でトレー・食器を受け取る。「ありがとうございました」と声掛け',
                    tips: '食べ残しや汚れをチェック。番号札も一緒に回収'
                },
                {
                    action: '洗浄',
                    procedure: 'トレーは使用後すぐに洗浄。乾燥後に再利用',
                    tips: '営業中は予備トレーをローテーション'
                }
            ],
            expression: '「トレーごと」= トレーに載せて提供・回収する方式（現場ルール）'
        },
        returnCounter: {
            title: '返却口運用',
            setup: [
                '位置: カウンター近く、入口から見やすい場所',
                '案内: 「返却口」の掲示を設置',
                'スペース: トレー・食器を一時的に置ける広さを確保'
            ],
            operations: [
                'お客様がトレーごと返却 → スタッフが受け取り「ありがとうございました」',
                '番号札をその場で回収し、番号札立てに戻す',
                '食器・トレーを洗浄エリアに運ぶ',
                'ゴミはお客様が近くのゴミ箱に捨てるよう案内'
            ],
            congestion: [
                '混雑時: スタッフ1名を返却口に常駐',
                'トレーが溜まったら優先的に洗浄エリアへ運ぶ',
                '返却待ちが発生したら、臨時置場を用意'
            ]
        },
        flow: {
            title: 'フロー（来店〜退店）',
            steps: [
                { number: 1, action: '入店', detail: 'お客様が入店。「いらっしゃいませ」と挨拶' },
                { number: 2, action: 'レジ・番号札', detail: '注文・会計を行い、番号札を受け取る' },
                { number: 3, action: '着席（自由席）', detail: '好きな席に座って番号を呼ばれるまで待機' },
                { number: 4, action: '商品受取', detail: '番号が呼ばれたらカウンターで商品を受け取る' },
                { number: 5, action: '飲食', detail: '席で商品を楽しむ' },
                { number: 6, action: '返却', detail: 'トレーごと返却口へ。番号札も一緒に返却' },
                { number: 7, action: '退店', detail: '「ありがとうございました」とお見送り' }
            ],
            mermaid: `flowchart LR
    A[入店] --> B[レジ・番号札]
    B --> C[着席 自由席]
    C --> D[商品受取]
    D --> E[飲食]
    E --> F[返却]
    F --> G[退店]
    F -. 番号札を戻す .-> B`,
            notes: [
                '「着席」のタイミングで席を確保。混雑時は相席をお願いすることも',
                '「返却」から「レジ・番号札」へのループ: 番号札が戻り、次のお客様へ'
            ]
        },
        safety: {
            title: '安全・衛生',
            items: [
                {
                    category: 'やけど防止',
                    measures: [
                        'トースターからパンを取り出す際はトングを使用',
                        '熱い商品は「熱いのでお気をつけください」と声掛け',
                        'スチームミルクやエスプレッソは適温で提供'
                    ]
                },
                {
                    category: '転倒防止',
                    measures: [
                        '床に水滴や食べこぼしがあればすぐに拭き取る',
                        '動線上に障害物を置かない',
                        'トレー運搬時は周囲に注意'
                    ]
                },
                {
                    category: '交差汚染防止',
                    measures: [
                        '手洗い: 作業前・会計後・清掃後に必ず実施',
                        'トングやスプーンは素材別に使い分け',
                        'ゴミ箱は食品動線外に配置'
                    ]
                },
                {
                    category: '手指消毒',
                    measures: [
                        '入口に手指消毒液を設置',
                        'スタッフは頻繁にアルコール消毒',
                        'お客様にも利用を促す掲示'
                    ]
                }
            ]
        },
        congestion: {
            title: '混雑時の運用',
            scenarios: [
                {
                    situation: '呼び出しが重なる',
                    action: '呼び出し間隔を調整。1組ずつ確実に渡す。複数同時の場合は番号順に'
                },
                {
                    situation: 'トレーが滞留',
                    action: '洗浄スタッフを一時的に増員。臨時置場（カウンター奥）を活用'
                },
                {
                    situation: '返却口が混雑',
                    action: 'スタッフ1名を返却口に常駐。「順番にお願いします」と整流'
                },
                {
                    situation: '席が埋まる',
                    action: '相席をお願いする。立ち見スペースや外のベンチを案内'
                }
            ]
        },
        signage: {
            title: '掲示物・サイン',
            signs: [
                {
                    location: '返却口',
                    text: '【返却口】\nトレー・食器・番号札をこちらへお返しください\nご協力ありがとうございます'
                },
                {
                    location: 'レジ横',
                    text: '【番号札】\n番号でお呼びしますので\nお好きな席でお待ちください'
                },
                {
                    location: '客席エリア',
                    text: '【自由席】\nお好きな席をご利用ください\n混雑時は相席にご協力をお願いいたします\n座席数: 31席（グループ2人×3、4人×2／大テーブル12／1人席5）'
                },
                {
                    location: 'ゴミ箱',
                    text: '【ゴミ分別】\n・燃えるゴミ\n・プラスチック\n・ビン・カン\nご協力ありがとうございます'
                },
                {
                    location: '入口',
                    text: '【手指消毒のお願い】\nご入店の際は手指消毒にご協力ください'
                }
            ]
        },
        checklist: {
            title: 'チェックリスト',
            periods: [
                {
                    period: '開店前',
                    items: [
                        'トースター2台の動作確認',
                        '番号札が全て揃っているか（10枚以上推奨）',
                        'トレーの在庫確認・清潔チェック',
                        '返却口の整理・清掃',
                        'ゴミ箱の空き確認・袋の設置',
                        '掲示物の確認・補修',
                        'カウンター・客席の清掃'
                    ]
                },
                {
                    period: '営業中',
                    items: [
                        '番号札の在庫確認（減ったら洗浄済みを補充）',
                        'トレーのローテーション（汚れたら即交換）',
                        '返却口の整理（トレー・食器を速やかに片付け）',
                        'ゴミ箱の確認（8割で交換）',
                        '床の水滴・食べこぼしチェック',
                        '客席の清掃（お客様退席後すぐに）',
                        '呼び出しの声量・タイミング確認'
                    ]
                },
                {
                    period: '閉店後',
                    items: [
                        '番号札の回収・アルコール消毒',
                        'トレー・食器の全数洗浄・乾燥',
                        '返却口の清掃・整理',
                        'ゴミの最終回収・分別',
                        'カウンター・客席の最終清掃',
                        'トースター2台の清掃・電源オフ',
                        '掲示物の状態確認',
                        '忘れ物チェック',
                        '戸締り・消灯確認'
                    ]
                }
            ]
        }
    }
};

// AirPayマニュアル
initialData.airpay = {
    title: 'AirPay 決済マニュアル',
    device: 'iPad + AirPayアプリ + AirPayリーダー（クレジット/交通系IC/QR/電子マネー対応）',
    methods: [
        {
            name: '1. クレジットカード決済',
            steps: [
                'AirPayホーム画面で「決済」をタッチし、「クレジットカード」を選択。',
                '金額を入力し「決済へ進む」。',
                'リーダーディスプレイの三角マークを確認し、カードをタッチ/挿入/スワイプ。端末の指示に従い暗証番号またはサインを取得。',
                '通信完了メッセージを確認し「次の決済へ」をタッチ。レシート希望があれば印刷。'
            ],
            notes: [
                'IC優先。タッチ非対応や失敗時はIC/磁気に切替。',
                '電子サインは端末画面に表示。'
            ]
        },
        {
            name: '2. QRコード決済',
            steps: [
                '「決済」→「QRコード」を選択し、金額入力→「決済へ進む」。',
                '店舗提示型 or お客様提示型を選択し、カメラ/リーダーでQRを読み取り。',
                '通信完了で決済完了を確認し、レシート希望を確認。'
            ],
            notes: [
                '画面反射や汚れがある場合は角度調整・輝度アップを案内。'
            ]
        },
        {
            name: '3. 交通系電子マネー／iD／QUICPay',
            steps: [
                '「決済」→決済種別を選択→金額入力→「決済へ進む」。',
                'カード/スマホをリーダーにタッチ。必要ならApple Pay/Google Payの認証を案内。',
                '完了メッセージを確認し取引終了。'
            ],
            notes: [
                '残高不足時は別決済を案内。タッチ位置を平らに当ててもらう。'
            ]
        },
        {
            name: '4. オンライン決済（リンク決済）',
            steps: [
                'AirPayから決済リンクを発行し、URL/QRを提示または送付。',
                'お客様がログインし、決済情報を入力。',
                '「支払い確定」で完了（メール通知が届く）。'
            ],
            notes: [
                '店頭での通信状況を確認し、完了画面を必ず目視。'
            ]
        }
    ],
    videos: [
        { title: '初期設定の手順', videoId: 'VAxNsDeAeSY', url: 'https://www.youtube.com/watch?v=VAxNsDeAeSY' },
        { title: '店舗スタッフ向け操作理解', videoId: '7A3AVgjT9BA', url: 'https://www.youtube.com/watch?v=7A3AVgjT9BA' },
        { title: '操作理解（Airレジ以外）', videoId: 'CLLMQhZUcK0', url: 'https://www.youtube.com/watch?v=CLLMQhZUcK0' },
        { title: '交通系電子マネー／iD／QUICPay', videoId: 'iFs_cMATTgA', url: 'https://www.youtube.com/watch?v=iFs_cMATTgA' },
        { title: 'QRコード決済手順', videoId: 'p6zd4pMou5Q', url: 'https://www.youtube.com/watch?v=p6zd4pMou5Q' },
        { title: 'QRコード決済操作', videoId: 'YCpvzsHDTKw', url: 'https://www.youtube.com/watch?v=YCpvzsHDTKw' },
        { title: '決済概要紹介', videoId: 'LVZ6WSZFIRs', url: 'https://www.youtube.com/watch?v=LVZ6WSZFIRs' },
        { title: '電子マネー決済（iD／QUICPay）', videoId: 'p4mEGa40yP0', url: 'https://www.youtube.com/watch?v=p4mEGa40yP0' },
        { title: '決済サービス紹介', videoId: 'gK09dFGnWxo', url: 'https://www.youtube.com/watch?v=gK09dFGnWxo' }
    ],
    checklist: [
        'iPad／端末の電源確認',
        'Airペイアプリの起動・ログイン',
        'カードリーダーの電源／Bluetooth接続',
        'ネットワーク（Wi-Fi/4G）接続確認',
        '決済前に金額・取引内容を再確認',
        'リーダーの向き・カードのタッチ位置の確認'
    ],
    cautions: [
        '通信中は端末を動かさない',
        'カードはタッチ位置を意識（上部／中央など）',
        'クレジットカード決済は暗証番号 or サイン対応あり',
        'QRコードは汚れ・反射に注意',
        '電子マネーは残高不足時の案内を丁寧に'
    ],
    troubles: [
        '読み取り失敗: カードのタッチ位置を変える／IC挿入へ切替',
        '通信エラー: ネットワーク再確認→再試行',
        '取引不明: Airペイ管理画面でステータスを確認',
        '決済二重疑い: お客様アプリ／レシートで履歴確認'
    ]
};

// ===================================
// 在庫管理設定
// ===================================

// GAS API URL（デプロイ後に設定）
// 設定手順: gas/README.md を参照
const INVENTORY_API_URL = 'https://script.google.com/macros/s/AKfycbwPsdgYV8Q7ycv5hUDFAXTKjTPX5kJatgiTPE6hwcZjjcz6eVZV3quQ1Lm0B0xrrmRk/exec';  // 例: 'https://script.google.com/macros/s/xxxxx/exec'

// スプレッドシートURL
const SPREADSHEET_URL = 'https://docs.google.com/spreadsheets/d/1ulBqzA_lS_J7eJeR2u0t5Mzkzyj-Z4BH-f9XRVBf9T4/edit';

// =========================================
// 在庫管理システム拡張性設定 v2.4
// =========================================

/**
 * カテゴリ分類ルール（クライアント側）
 * GAS側の CATEGORY_RULES と同期させる
 * 新しいカテゴリを追加する場合はここに追記
 */
const INVENTORY_CATEGORY_RULES = {
    'コーヒー': ['コーヒー豆', 'エスプレッソ'],
    '乳製品・冷蔵': ['牛乳', 'ホイップクリーム', 'ミルク', '氷'],
    'シロップ・ソース': ['チョコソース', 'キャラメルソース', 'バニラシロップ', 'チャイシロップ', 'ホワイトチョコソース'],
    'パウダー・茶葉': ['抹茶パウダー', 'ほうじ茶パウダー', 'アールグレイ'],
    '消耗品（容器）': ['紙カップ', 'フタ', 'プラカップ', 'プラフタ', 'マドラー', 'ストロー'],
    '消耗品（調味料）': ['シュガー', 'ガムシロップ'],
    '衛生・清掃用品': ['手袋', '消毒液', 'アルコール', 'ペーパータオル', 'スポンジ', '洗剤'],
    'その他': []
};

/**
 * 単位推測ルール（クライアント側）
 * 優先度順に評価される（上から順に評価し、最初にマッチしたものを使用）
 * 新しいルールを追加する場合はここに追記
 */
const INVENTORY_UNIT_RULES = [
    // ========== 優先度1: コーヒー豆（最優先 - 「シティー」に「ティー」が含まれるため） ==========
    { pattern: 'コーヒー豆', unit: 'g' },
    { pattern: 'エスプレッソ豆', unit: 'g' },
    { pattern: 'ロースト', unit: 'g' },          // シティロースト、ヨーロピアンなど
    { pattern: 'ブラジル', unit: 'g' },          // 産地名でも対応
    // ========== 優先度2: 液体・ソース類 ==========
    { pattern: 'ソース', unit: '本' },
    { pattern: 'シロップ', unit: '本' },
    { pattern: '牛乳', unit: '本' },
    { pattern: 'ホイップ', unit: '本' },
    { pattern: 'クリーム', unit: '本' },
    { pattern: '消毒', unit: '本' },
    { pattern: '洗剤', unit: '本' },
    { pattern: 'スプレー', unit: '本' },
    // ========== 優先度3: 粉末・茶葉 ==========
    { pattern: 'パウダー', unit: '袋' },
    { pattern: '氷', unit: '袋' },
    { pattern: '紅茶', unit: '袋' },             // 「ティー」→「紅茶」に変更（シティーとの誤マッチ防止）
    { pattern: 'アールグレイ', unit: '袋' },
    // ========== 優先度4: 包装形態 ==========
    { pattern: '個入り', unit: '箱' },
    { pattern: '本入り', unit: '箱' },
    { pattern: '袋', unit: '袋' },
    { pattern: '組', unit: '組' },
    { pattern: '手袋', unit: '箱' }
];

/**
 * 商品名からカテゴリを自動判定（クライアント側）
 * @param {string} itemName - 商品名
 * @returns {string} カテゴリ名
 */
function categorizeItemClient(itemName) {
    const name = String(itemName).toLowerCase();
    for (const [category, keywords] of Object.entries(INVENTORY_CATEGORY_RULES)) {
        for (const keyword of keywords) {
            if (name.includes(keyword.toLowerCase())) {
                return category;
            }
        }
    }
    return 'その他';
}

/**
 * 商品名から単位を推測（クライアント側）
 * @param {string} itemName - 商品名
 * @returns {string} 単位
 */
function inferUnitClient(itemName) {
    const name = String(itemName).toLowerCase();
    for (const rule of INVENTORY_UNIT_RULES) {
        if (name.includes(rule.pattern.toLowerCase())) {
            return rule.unit;
        }
    }
    return '個'; // デフォルト
}

/**
 * 在庫アイテムから派生データを自動生成
 * orderList, inProgressList, summary, categories を items から生成
 * @param {Array} items - 在庫アイテム配列
 * @returns {Object} 派生データ
 */
function generateInventoryDerivedData(items) {
    const orderList = [];
    const inProgressList = [];
    const categories = {};
    let completed = 0;

    items.forEach(item => {
        // ステータスに基づいてリストを振り分け
        if (item.statusType === 'pending' || item.needsOrder) {
            orderList.push({
                name: item.name,
                category: item.category,
                remaining: item.remaining,
                orderLine: item.orderLine,
                unit: item.unit,
                statusType: 'pending'
            });
        } else if (item.statusType === 'in_progress' || item.inProgress) {
            inProgressList.push({
                name: item.name,
                category: item.category,
                remaining: item.remaining,
                unit: item.unit,
                statusType: 'in_progress'
            });
        } else {
            completed++;
        }

        // カテゴリ別にグループ化
        const category = item.category || 'その他';
        if (!categories[category]) {
            categories[category] = [];
        }
        categories[category].push(item);
    });

    // カテゴリ内を仕入れ状況優先でソート
    for (const category of Object.keys(categories)) {
        categories[category].sort((a, b) => {
            if (a.needsOrder && !b.needsOrder) return -1;
            if (!a.needsOrder && b.needsOrder) return 1;
            if (a.inProgress && !b.inProgress) return -1;
            if (!a.inProgress && b.inProgress) return 1;
            return (a.stockRatio || 100) - (b.stockRatio || 100);
        });
    }

    return {
        orderList,
        inProgressList,
        categories,
        summary: {
            totalItems: items.length,
            needsOrder: orderList.length,
            inProgress: inProgressList.length,
            completed: completed
        }
    };
}

// =========================================
// フォールバック用の在庫データ v2.4
// =========================================
// 新しい商品を追加する場合は items 配列に追加するだけでOK
// orderList, inProgressList, summary, categories は自動生成される

const fallbackInventoryData = {
    version: '2.5',
    items: [
        // コーヒー（全て完了）
        { name: 'コーヒー豆（シティーローストブラジル）（100g)', category: 'コーヒー', remaining: 2500, ideal: 2000, initial: 3000, orderLine: 1000, unit: 'g', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 125 },
        { name: 'コーヒー豆（ヨーロピアン）（100ｇ）', category: 'コーヒー', remaining: 3000, ideal: 2000, initial: 3000, orderLine: 1000, unit: 'g', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 150 },
        // 乳製品・冷蔵（全て完了）
        { name: '牛乳(1000ml)', category: '乳製品・冷蔵', remaining: 100, ideal: 15, initial: 15, orderLine: 10, unit: '本', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 667 },
        { name: '氷（3kg）', category: '乳製品・冷蔵', remaining: 1, ideal: 1, initial: 1, orderLine: 0.5, unit: '袋', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'ホイップクリーム(1L)', category: '乳製品・冷蔵', remaining: 1, ideal: 1, initial: 1, orderLine: 0.5, unit: '本', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        // シロップ・ソース（デモ用：未申請2件、申請中2件、完了1件）
        { name: 'チョコソース（240g）', category: 'シロップ・ソース', remaining: 1, ideal: 2, initial: 1, orderLine: 2, unit: '本', purchaseStatus: '未申請', status: '未申請', statusType: 'pending', needsOrder: true, inProgress: false, stockRatio: 50 },
        { name: 'キャラメルソース(240g)', category: 'シロップ・ソース', remaining: 1, ideal: 2, initial: 2, orderLine: 1, unit: '本', purchaseStatus: '未申請', status: '未申請', statusType: 'pending', needsOrder: true, inProgress: false, stockRatio: 50 },
        { name: 'バニラシロップ（250ml）', category: 'シロップ・ソース', remaining: 1, ideal: 2, initial: 2, orderLine: 1, unit: '本', purchaseStatus: '仕入れ申請中', status: '申請中', statusType: 'in_progress', needsOrder: false, inProgress: true, stockRatio: 50 },
        { name: 'チャイシロップ（250ml）', category: 'シロップ・ソース', remaining: 1, ideal: 2, initial: 2, orderLine: 1, unit: '本', purchaseStatus: '仕入れ申請中', status: '申請中', statusType: 'in_progress', needsOrder: false, inProgress: true, stockRatio: 50 },
        { name: 'ホワイトチョコソース(500ml)', category: 'シロップ・ソース', remaining: 1, ideal: 2, initial: 2, orderLine: 1, unit: '本', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 50 },
        // パウダー・茶葉（デモ用：未申請1件、申請中1件、完了1件）
        { name: '抹茶パウダー（170g）', category: 'パウダー・茶葉', remaining: 1, ideal: 2, initial: 2, orderLine: 1, unit: '袋', purchaseStatus: '未申請', status: '未申請', statusType: 'pending', needsOrder: true, inProgress: false, stockRatio: 50 },
        { name: 'ほうじ茶パウダー（170g)', category: 'パウダー・茶葉', remaining: 1, ideal: 2, initial: 2, orderLine: 1, unit: '袋', purchaseStatus: '仕入れ申請中', status: '申請中', statusType: 'in_progress', needsOrder: false, inProgress: true, stockRatio: 50 },
        { name: 'アールグレイパック（20個）', category: 'パウダー・茶葉', remaining: 1, ideal: 2, initial: 2, orderLine: 1, unit: '袋', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 50 },
        // 消耗品（容器）（全て完了）
        { name: '紙カップ（1200個入り）', category: '消耗品（容器）', remaining: 1, ideal: 1, initial: 1, orderLine: 0.5, unit: '箱', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'フタ（1200個入り）', category: '消耗品（容器）', remaining: 1, ideal: 1, initial: 1, orderLine: 0.5, unit: '箱', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'プラカップ（1000個入り）', category: '消耗品（容器）', remaining: 1, ideal: 1, initial: 1, orderLine: 0.5, unit: '箱', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'プラフタ（1000個入り）', category: '消耗品（容器）', remaining: 1, ideal: 1, initial: 1, orderLine: 0.5, unit: '箱', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'マドラー（1000個入り）', category: '消耗品（容器）', remaining: 1, ideal: 1, initial: 1, orderLine: 0.5, unit: '箱', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'ストロー(500本×2)', category: '消耗品（容器）', remaining: 2, ideal: 2, initial: 2, orderLine: 1, unit: '袋', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        // 消耗品（調味料）（全て完了）
        { name: 'シュガー(３g×１２０本入り)', category: '消耗品（調味料）', remaining: 2, ideal: 2, initial: 2, orderLine: 1, unit: '袋', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'ガムシロップ（13g×50個入り）', category: '消耗品（調味料）', remaining: 2, ideal: 2, initial: 2, orderLine: 1, unit: '袋', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: 'ミルク（55個入り）', category: '消耗品（調味料）', remaining: 2, ideal: 2, initial: 2, orderLine: 1, unit: '袋', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        // 衛生・清掃用品（デモ用：未申請2件、申請中2件、完了2件）
        { name: '使いきり手袋', category: '衛生・清掃用品', remaining: 2, ideal: 0, initial: 2, orderLine: 50, unit: '組', purchaseStatus: '未申請', status: '未申請', statusType: 'pending', needsOrder: true, inProgress: false, stockRatio: 100 },
        { name: '消毒液　手用', category: '衛生・清掃用品', remaining: 2, ideal: 0, initial: 2, orderLine: 2, unit: '本', purchaseStatus: '未申請', status: '未申請', statusType: 'pending', needsOrder: true, inProgress: false, stockRatio: 100 },
        { name: 'キッチン用アルコール除菌スプレー', category: '衛生・清掃用品', remaining: 2, ideal: 0, initial: 2, orderLine: 2, unit: '本', purchaseStatus: '仕入れ申請中', status: '申請中', statusType: 'in_progress', needsOrder: false, inProgress: true, stockRatio: 100 },
        { name: 'ペーパータオル', category: '衛生・清掃用品', remaining: 2, ideal: 0, initial: 2, orderLine: 2, unit: '個', purchaseStatus: '仕入れ申請中', status: '申請中', statusType: 'in_progress', needsOrder: false, inProgress: true, stockRatio: 100 },
        { name: '食器用スポンジ', category: '衛生・清掃用品', remaining: 2, ideal: 0, initial: 2, orderLine: 2, unit: '個', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 },
        { name: '食器用洗剤', category: '衛生・清掃用品', remaining: 2, ideal: 0, initial: 2, orderLine: 0, unit: '本', purchaseStatus: '完了', status: '完了', statusType: 'completed', needsOrder: false, inProgress: false, stockRatio: 100 }
    ],
    storage: [
        { name: 'コーヒー豆', beforeOpen: '常温', afterOpen: '常温', expiryDays: '2週間', notes: '瓶で密封' },
        { name: 'スティックシュガー', beforeOpen: '常温', afterOpen: '常温', expiryDays: '特になし', notes: '冷暗所' },
        { name: 'ガムシロップ', beforeOpen: '常温', afterOpen: '常温', expiryDays: '特になし', notes: '冷暗所' },
        { name: 'チョコソース', beforeOpen: '常温', afterOpen: '閉店時：冷蔵庫\n開店時：常温', expiryDays: '1か月', notes: '注ぎ口を清潔に' },
        { name: 'ホワイトチョコソース', beforeOpen: '常温', afterOpen: '閉店時：冷蔵庫\n開店時：常温', expiryDays: '1か月', notes: '注ぎ口を清潔に' },
        { name: 'キャラメル', beforeOpen: '常温', afterOpen: '閉店時：冷蔵庫\n開店時：常温', expiryDays: '1か月', notes: '注ぎ口を清潔に' },
        { name: 'バニラシロップ', beforeOpen: '常温', afterOpen: '閉店時：冷蔵庫\n開店時：常温', expiryDays: '1か月', notes: '注ぎ口を清潔に' },
        { name: 'チャイシロップ', beforeOpen: '常温', afterOpen: '閉店時：冷蔵庫\n開店時：常温', expiryDays: '3週間', notes: '注ぎ口を清潔に' },
        { name: '抹茶パウダー', beforeOpen: '常温', afterOpen: '冷蔵庫', expiryDays: '1か月', notes: '密封保存' },
        { name: 'ほうじ茶パウダー', beforeOpen: '常温', afterOpen: '冷蔵庫', expiryDays: '1か月', notes: '密封保存' },
        { name: 'アールグレイティー', beforeOpen: '常温', afterOpen: '冷蔵庫', expiryDays: '1か月', notes: '密封保存' },
        { name: '牛乳', beforeOpen: '冷蔵庫', afterOpen: '冷蔵庫', expiryDays: '消費が早いため特になし', notes: '最重要' },
        { name: 'ホイップクリーム', beforeOpen: '冷凍庫', afterOpen: '冷蔵庫', expiryDays: '5日', notes: '痛みに注意' },
        { name: '氷', beforeOpen: '冷凍庫', afterOpen: '冷凍庫', expiryDays: '特になし', notes: '特になし' }
    ],
    // v2.4: orderList, inProgressList, summary, categories は自動生成
    // generateInventoryDerivedData(items) で生成される
    timestamp: null
};

// v2.4: フォールバックデータの派生データを自動生成
// これにより items を編集するだけで他のデータも自動更新される
(function initializeFallbackData() {
    const derived = generateInventoryDerivedData(fallbackInventoryData.items);
    fallbackInventoryData.orderList = derived.orderList;
    fallbackInventoryData.inProgressList = derived.inProgressList;
    fallbackInventoryData.summary = derived.summary;
    fallbackInventoryData.categories = derived.categories;
})();

// LocalStorageのキー
const STORAGE_KEYS = {
    MENU_DATA: 'cafeManual_menuData',
    CLEANING_DATA: 'cafeManual_cleaningData',
    SERVICE_DATA: 'cafeManual_serviceData',
    IMAGES: 'cafeManual_images',
    SETTINGS: 'cafeManual_settings',
    UPDATE_HISTORY: 'cafeManual_updateHistory',
    CALENDAR_EMBED: 'cafeManual_calendarEmbed',
    INVENTORY_CACHE: 'cafeManual_inventoryCache'
};

// デフォルト設定
const defaultSettings = {
    editMode: false,
    lastBackup: null,
    version: '1.0.0'
};
